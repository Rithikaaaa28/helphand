{% extends "base.html" %}

{% block title %}Setup Volunteer Profile - HelpHand{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto">
    <div class="bg-white shadow rounded-lg">
        <div class="px-4 py-5 sm:p-6">
            <h3 class="text-lg leading-6 font-medium text-gray-900 mb-6">
                <i class="fas fa-user-cog mr-2 text-blue-600"></i>Setup Your Volunteer Profile
            </h3>

            <form method="POST" action="{{ url_for('volunteer.setup_profile') }}" enctype="multipart/form-data" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-4">
                        <i class="fas fa-briefcase mr-2"></i>Select Your Skills & Services
                    </label>
                    <p class="text-sm text-gray-500 mb-4">Choose the areas where you can help. Select all that apply.</p>
                    
                    <!-- Skills Grid -->
                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3" id="skills-grid">
                        <!-- Home & Maintenance -->
                        <div class="skill-card">
                            <input type="checkbox" id="skill-home-repairs" name="skills[]" value="Home repairs" class="skill-checkbox">
                            <label for="skill-home-repairs" class="skill-label">
                                <div class="skill-icon">üîß</div>
                                <div class="skill-name">Home Repairs</div>
                            </label>
                        </div>
                        
                        <div class="skill-card">
                            <input type="checkbox" id="skill-plumbing" name="skills[]" value="Plumbing" class="skill-checkbox">
                            <label for="skill-plumbing" class="skill-label">
                                <div class="skill-icon">üö∞</div>
                                <div class="skill-name">Plumbing</div>
                            </label>
                        </div>
                        
                        <div class="skill-card">
                            <input type="checkbox" id="skill-electrical" name="skills[]" value="Electrical work" class="skill-checkbox">
                            <label for="skill-electrical" class="skill-label">
                                <div class="skill-icon">üí°</div>
                                <div class="skill-name">Electrical</div>
                            </label>
                        </div>
                        
                        <div class="skill-card">
                            <input type="checkbox" id="skill-painting" name="skills[]" value="Painting" class="skill-checkbox">
                            <label for="skill-painting" class="skill-label">
                                <div class="skill-icon">üé®</div>
                                <div class="skill-name">Painting</div>
                            </label>
                        </div>
                        
                        <div class="skill-card">
                            <input type="checkbox" id="skill-carpentry" name="skills[]" value="Carpentry" class="skill-checkbox">
                            <label for="skill-carpentry" class="skill-label">
                                <div class="skill-icon">ü™ö</div>
                                <div class="skill-name">Carpentry</div>
                            </label>
                        </div>
                        
                        <div class="skill-card">
                            <input type="checkbox" id="skill-gardening" name="skills[]" value="Gardening" class="skill-checkbox">
                            <label for="skill-gardening" class="skill-label">
                                <div class="skill-icon">üå±</div>
                                <div class="skill-name">Gardening</div>
                            </label>
                        </div>
                        
                        <!-- Household Services -->
                        <div class="skill-card">
                            <input type="checkbox" id="skill-cleaning" name="skills[]" value="House cleaning" class="skill-checkbox">
                            <label for="skill-cleaning" class="skill-label">
                                <div class="skill-icon">üßπ</div>
                                <div class="skill-name">Cleaning</div>
                            </label>
                        </div>
                        
                        <div class="skill-card">
                            <input type="checkbox" id="skill-cooking" name="skills[]" value="Cooking" class="skill-checkbox">
                            <label for="skill-cooking" class="skill-label">
                                <div class="skill-icon">üë®‚Äçüç≥</div>
                                <div class="skill-name">Cooking</div>
                            </label>
                        </div>
                        
                        <div class="skill-card">
                            <input type="checkbox" id="skill-laundry" name="skills[]" value="Laundry" class="skill-checkbox">
                            <label for="skill-laundry" class="skill-label">
                                <div class="skill-icon">üß∫</div>
                                <div class="skill-name">Laundry</div>
                            </label>
                        </div>
                        
                        <!-- Shopping & Errands -->
                        <div class="skill-card">
                            <input type="checkbox" id="skill-grocery" name="skills[]" value="Grocery shopping" class="skill-checkbox">
                            <label for="skill-grocery" class="skill-label">
                                <div class="skill-icon">üõí</div>
                                <div class="skill-name">Grocery Shopping</div>
                            </label>
                        </div>
                        
                        <div class="skill-card">
                            <input type="checkbox" id="skill-errands" name="skills[]" value="Running errands" class="skill-checkbox">
                            <label for="skill-errands" class="skill-label">
                                <div class="skill-icon">üèÉ</div>
                                <div class="skill-name">Errands</div>
                            </label>
                        </div>
                        
                        <div class="skill-card">
                            <input type="checkbox" id="skill-delivery" name="skills[]" value="Delivery services" class="skill-checkbox">
                            <label for="skill-delivery" class="skill-label">
                                <div class="skill-icon">üì¶</div>
                                <div class="skill-name">Delivery</div>
                            </label>
                        </div>
                        
                        <!-- Care Services -->
                        <div class="skill-card">
                            <input type="checkbox" id="skill-elderly" name="skills[]" value="Elderly care" class="skill-checkbox">
                            <label for="skill-elderly" class="skill-label">
                                <div class="skill-icon">üë¥</div>
                                <div class="skill-name">Elderly Care</div>
                            </label>
                        </div>
                        
                        <div class="skill-card">
                            <input type="checkbox" id="skill-childcare" name="skills[]" value="Child care" class="skill-checkbox">
                            <label for="skill-childcare" class="skill-label">
                                <div class="skill-icon">üë∂</div>
                                <div class="skill-name">Child Care</div>
                            </label>
                        </div>
                        
                        <div class="skill-card">
                            <input type="checkbox" id="skill-pet" name="skills[]" value="Pet care" class="skill-checkbox">
                            <label for="skill-pet" class="skill-label">
                                <div class="skill-icon">üêï</div>
                                <div class="skill-name">Pet Care</div>
                            </label>
                        </div>
                        
                        <div class="skill-card">
                            <input type="checkbox" id="skill-companionship" name="skills[]" value="Companionship" class="skill-checkbox">
                            <label for="skill-companionship" class="skill-label">
                                <div class="skill-icon">ü§ù</div>
                                <div class="skill-name">Companionship</div>
                            </label>
                        </div>
                        
                        <!-- Education & Technology -->
                        <div class="skill-card">
                            <input type="checkbox" id="skill-tutoring" name="skills[]" value="Tutoring" class="skill-checkbox">
                            <label for="skill-tutoring" class="skill-label">
                                <div class="skill-icon">üìö</div>
                                <div class="skill-name">Tutoring</div>
                            </label>
                        </div>
                        
                        <div class="skill-card">
                            <input type="checkbox" id="skill-computer" name="skills[]" value="Computer help" class="skill-checkbox">
                            <label for="skill-computer" class="skill-label">
                                <div class="skill-icon">üíª</div>
                                <div class="skill-name">Computer Help</div>
                            </label>
                        </div>
                        
                        <div class="skill-card">
                            <input type="checkbox" id="skill-phone" name="skills[]" value="Phone/tech support" class="skill-checkbox">
                            <label for="skill-phone" class="skill-label">
                                <div class="skill-icon">üì±</div>
                                <div class="skill-name">Tech Support</div>
                            </label>
                        </div>
                        
                        <!-- Transportation -->
                        <div class="skill-card">
                            <input type="checkbox" id="skill-driving" name="skills[]" value="Driving/transportation" class="skill-checkbox">
                            <label for="skill-driving" class="skill-label">
                                <div class="skill-icon">üöó</div>
                                <div class="skill-name">Transportation</div>
                            </label>
                        </div>
                        
                        <div class="skill-card">
                            <input type="checkbox" id="skill-moving" name="skills[]" value="Moving assistance" class="skill-checkbox">
                            <label for="skill-moving" class="skill-label">
                                <div class="skill-icon">üì¶</div>
                                <div class="skill-name">Moving Help</div>
                            </label>
                        </div>
                        
                        <!-- Professional Services -->
                        <div class="skill-card">
                            <input type="checkbox" id="skill-admin" name="skills[]" value="Administrative tasks" class="skill-checkbox">
                            <label for="skill-admin" class="skill-label">
                                <div class="skill-icon">üìã</div>
                                <div class="skill-name">Admin Tasks</div>
                            </label>
                        </div>
                        
                        <div class="skill-card">
                            <input type="checkbox" id="skill-translation" name="skills[]" value="Translation" class="skill-checkbox">
                            <label for="skill-translation" class="skill-label">
                                <div class="skill-icon">üåê</div>
                                <div class="skill-name">Translation</div>
                            </label>
                        </div>
                        
                        <div class="skill-card">
                            <input type="checkbox" id="skill-photography" name="skills[]" value="Photography" class="skill-checkbox">
                            <label for="skill-photography" class="skill-label">
                                <div class="skill-icon">üì∑</div>
                                <div class="skill-name">Photography</div>
                            </label>
                        </div>
                        
                        <!-- Other -->
                        <div class="skill-card">
                            <input type="checkbox" id="skill-other" name="skills[]" value="Other services" class="skill-checkbox">
                            <label for="skill-other" class="skill-label">
                                <div class="skill-icon">‚ú®</div>
                                <div class="skill-name">Other</div>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Hidden input to store selected skills as comma-separated string -->
                    <input type="hidden" id="skills" name="skills" required>
                    
                    <!-- Additional skills textarea (optional) -->
                    <div class="mt-4">
                        <label for="additional-skills" class="block text-xs font-medium text-gray-600 mb-2">
                            Additional Details (Optional)
                        </label>
                        <textarea id="additional-skills" name="additional_skills" rows="2"
                                  class="block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm"
                                  placeholder="Add any specific experience or additional skills not listed above..."></textarea>
                    </div>
                    
                    <p class="mt-3 text-sm text-gray-500">
                        <span id="skill-count" class="font-semibold text-blue-600">0</span> skills selected. 
                        Select at least one to continue.
                    </p>
                </div>
                
                <style>
                    .skill-card {
                        position: relative;
                    }
                    
                    .skill-checkbox {
                        position: absolute;
                        opacity: 0;
                        pointer-events: none;
                    }
                    
                    .skill-label {
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        padding: 1rem 0.5rem;
                        border: 2px solid #e5e7eb;
                        border-radius: 0.5rem;
                        cursor: pointer;
                        transition: all 0.2s ease;
                        background: white;
                        text-align: center;
                    }
                    
                    .skill-label:hover {
                        border-color: #3b82f6;
                        background: #eff6ff;
                        transform: translateY(-2px);
                        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
                    }
                    
                    .skill-checkbox:checked + .skill-label {
                        border-color: #3b82f6;
                        background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
                        color: white;
                        box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
                    }
                    
                    .skill-icon {
                        font-size: 2rem;
                        margin-bottom: 0.5rem;
                        filter: grayscale(50%);
                        transition: all 0.2s ease;
                    }
                    
                    .skill-checkbox:checked + .skill-label .skill-icon {
                        filter: grayscale(0%) brightness(1.2);
                        transform: scale(1.1);
                    }
                    
                    .skill-name {
                        font-size: 0.75rem;
                        font-weight: 500;
                        line-height: 1.2;
                    }
                    
                    .skill-checkbox:checked + .skill-label .skill-name {
                        font-weight: 600;
                    }
                </style>
                
                <script>
                    // Update hidden input and counter when skills are selected
                    document.addEventListener('DOMContentLoaded', function() {
                        const checkboxes = document.querySelectorAll('.skill-checkbox');
                        const hiddenInput = document.getElementById('skills');
                        const counter = document.getElementById('skill-count');
                        
                        function updateSkills() {
                            const selected = Array.from(checkboxes)
                                .filter(cb => cb.checked)
                                .map(cb => cb.value);
                            
                            hiddenInput.value = selected.join(', ');
                            counter.textContent = selected.length;
                            
                            // Add visual feedback
                            if (selected.length > 0) {
                                counter.classList.add('text-green-600');
                                counter.classList.remove('text-blue-600');
                            } else {
                                counter.classList.add('text-blue-600');
                                counter.classList.remove('text-green-600');
                            }
                        }
                        
                        checkboxes.forEach(checkbox => {
                            checkbox.addEventListener('change', updateSkills);
                        });
                        
                        // Initialize
                        updateSkills();
                    });
                </script>

                <div>
                    <label for="document" class="block text-sm font-medium text-gray-700">ID Verification Document</label>
                    <div class="mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md" id="dropzone">
                        <div class="space-y-1 text-center">
                            <svg id="upload-icon" class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48">
                                <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                            <div id="preview-container" style="display: none;">
                                <img id="image-preview" class="mx-auto max-h-48 rounded" alt="Document preview">
                            </div>
                            <div class="flex text-sm text-gray-600">
                                <label for="document" class="relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500">
                                    <span id="upload-text">Upload a file</span>
                                    <input id="document" name="document" type="file" class="sr-only" accept="image/*,.png,.jpg,.jpeg,.gif,.bmp" required onchange="previewImage(this)">
                                </label>
                                <p class="pl-1">or drag and drop</p>
                            </div>
                            <p class="text-xs text-gray-500">
                                PNG, JPG, JPEG, GIF, BMP up to 16MB
                            </p>
                        </div>
                    </div>
                    <p class="mt-2 text-sm text-gray-500">
                        Upload a clear photo of your government-issued ID (Aadhaar Card, PAN Card, Driving License, or Passport).
                        Our OCR system will automatically extract and verify your information.
                    </p>
                </div>

                <script>
                function previewImage(input) {
                    const preview = document.getElementById('image-preview');
                    const previewContainer = document.getElementById('preview-container');
                    const uploadIcon = document.getElementById('upload-icon');
                    const uploadText = document.getElementById('upload-text');
                    
                    if (input.files && input.files[0]) {
                        const reader = new FileReader();
                        
                        reader.onload = function(e) {
                            preview.src = e.target.result;
                            previewContainer.style.display = 'block';
                            uploadIcon.style.display = 'none';
                            uploadText.textContent = 'Change file';
                        }
                        
                        reader.readAsDataURL(input.files[0]);
                    }
                }
                </script>

                <!-- Verification Info -->
                <div class="bg-blue-50 rounded-lg p-4">
                    <h4 class="text-sm font-medium text-blue-800 mb-2">üìã Verification Process</h4>
                    <ul class="text-sm text-blue-700 space-y-1">
                        <li>‚Ä¢ Your document will be processed using OCR technology</li>
                        <li>‚Ä¢ Admin will review extracted information for accuracy</li>
                        <li>‚Ä¢ You'll receive email notification once verified</li>
                        <li>‚Ä¢ Typically takes 24-48 hours for approval</li>
                    </ul>
                </div>

                <!-- Premium Verification Option -->
                <div class="border border-yellow-200 bg-yellow-50 rounded-lg p-4" id="premium-section">
                    <div class="flex items-start">
                        <div class="flex items-center h-5">
                            <input id="premium_verification" name="premium_verification" type="checkbox" 
                                   class="h-4 w-4 text-yellow-600 focus:ring-yellow-500 border-gray-300 rounded"
                                   onchange="togglePremiumInfo()">
                        </div>
                        <div class="ml-3 flex-1">
                            <label for="premium_verification" class="font-medium text-yellow-800">
                                ‚ö° Premium Verification - ‚Çπ99
                            </label>
                            <p class="text-sm text-yellow-700 mt-1">Get verified within 2 hours + premium badge on your profile</p>
                            
                            <!-- Premium Benefits -->
                            <div id="premium-details" class="mt-3 p-3 bg-white rounded border border-yellow-200" style="display: none;">
                                <h5 class="text-sm font-semibold text-gray-900 mb-2">‚ú® Premium Benefits:</h5>
                                <ul class="text-xs text-gray-700 space-y-1">
                                    <li>‚úì Fast-track verification (within 2 hours)</li>
                                    <li>‚úì Premium badge on profile</li>
                                    <li>‚úì Priority in task matching</li>
                                    <li>‚úì Higher visibility to task posters</li>
                                    <li>‚úì Dedicated support</li>
                                </ul>
                                <div class="mt-3 pt-3 border-t border-yellow-200">
                                    <p class="text-xs text-gray-600">
                                        <strong>Payment:</strong> Secure payment will be processed upon submission.
                                        <span class="text-yellow-700">Total: ‚Çπ99</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <script>
                function togglePremiumInfo() {
                    const checkbox = document.getElementById('premium_verification');
                    const details = document.getElementById('premium-details');
                    const section = document.getElementById('premium-section');
                    
                    if (checkbox.checked) {
                        details.style.display = 'block';
                        section.classList.add('ring-2', 'ring-yellow-400');
                    } else {
                        details.style.display = 'none';
                        section.classList.remove('ring-2', 'ring-yellow-400');
                    }
                }
                </script>

                <div class="flex items-center">
                    <input id="terms" name="terms" type="checkbox" required
                           class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                    <label for="terms" class="ml-2 block text-sm text-gray-900">
                        I agree to the <a href="{{ url_for('main.terms') }}" class="text-blue-600 hover:text-blue-500">Volunteer Terms</a> and 
                        <a href="{{ url_for('main.terms') }}" class="text-blue-600 hover:text-blue-500">Code of Conduct</a>
                    </label>
                </div>

                <div class="pt-6 border-t">
                    <div class="flex justify-end space-x-3">
                        <a href="{{ url_for('volunteer.dashboard') }}" 
                           class="bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                            Cancel
                        </a>
                        <button type="submit" 
                                class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                            Submit for Verification
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- What Happens Next -->
    <div class="mt-6 bg-gray-50 rounded-lg p-6">
        <h3 class="text-lg font-medium text-gray-900 mb-4">What happens next?</h3>
        <div class="space-y-4">
            <div class="flex items-start space-x-3">
                <div class="flex-shrink-0 h-6 w-6 bg-blue-600 rounded-full flex items-center justify-center">
                    <span class="text-white text-xs font-bold">1</span>
                </div>
                <div>
                    <h4 class="font-medium text-gray-900">Document Processing</h4>
                    <p class="text-sm text-gray-600">Our OCR system extracts information from your ID document automatically.</p>
                </div>
            </div>
            
            <div class="flex items-start space-x-3">
                <div class="flex-shrink-0 h-6 w-6 bg-blue-600 rounded-full flex items-center justify-center">
                    <span class="text-white text-xs font-bold">2</span>
                </div>
                <div>
                    <h4 class="font-medium text-gray-900">Admin Review</h4>
                    <p class="text-sm text-gray-600">Our team manually verifies the extracted information for accuracy and completeness.</p>
                </div>
            </div>
            
            <div class="flex items-start space-x-3">
                <div class="flex-shrink-0 h-6 w-6 bg-green-600 rounded-full flex items-center justify-center">
                    <span class="text-white text-xs font-bold">3</span>
                </div>
                <div>
                    <h4 class="font-medium text-gray-900">Start Helping</h4>
                    <p class="text-sm text-gray-600">Once approved, you can view and apply for tasks in your area!</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}